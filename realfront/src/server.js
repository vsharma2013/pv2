import App from './App';
import React from 'react';
import { StaticRouter } from 'react-router-dom';
import express from 'express';
import { renderToString } from 'react-dom/server';

const assets = require(process.env.RAZZLE_ASSETS_MANIFEST);

const server = express();
server
  .disable('x-powered-by')
  .use(express.static(process.env.RAZZLE_PUBLIC_DIR))
  .get('/*', (req, res) => {
    const context = {};
    const markup = renderToString(
      <StaticRouter context={context} location={req.url}>
        <App />
      </StaticRouter>
    );

    if (context.url) {
      res.redirect(context.url);
    } else {
      res.status(200).send(
        `<!doctype html>
    <html lang="">
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta charset="utf-8" />
        <title>Propviewz</title>
        <meta name="description" content="This is the main page for Propviewz"/>
        <meta property="og:image" content="data:image/png;base64,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">
        <meta property="og:image:width" content="50">
		    <meta property="og:image:height" content="50">
        <meta name="viewport" content="width=device-width, initial-scale=1"/>
        <meta name="google-site-verification" content="1cNE22jlxDrjN3x53SP4I6Y7BX3ZsNC4gjcqxm66ea8" />
        ${
          assets.client.css
            ? `<link rel="stylesheet" href="${assets.client.css}">`
            : ''
        }
        ${
          process.env.NODE_ENV === 'production'
          ? `<script src="${assets.client.js}" defer></script>`
          : `<script src="${assets.client.js}" defer crossorigin></script>`
        }
    </head>
    <body>
        <div style=overflow:hidden id="root">${markup}</div>
    </body>
</html>`
      );
    }
  });

export default server;
